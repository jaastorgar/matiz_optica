{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mis Reservas</title>

  <link rel="icon" href="{% static 'core/favicon.ico' %}" type="image/x-icon">
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <link rel="stylesheet" href="{% static 'appointments/css/mis_reservas.css' %}">
</head>

<body>

<main class="reservas-container">

  <h1>Mis Reservas</h1>

  {% if reservas %}

  <!-- CSRF TOKEN GLOBAL (para JS) -->
  <form style="display:none;">
    {% csrf_token %}
  </form>

  <!-- TABS -->
  <nav class="reservas-tabs">
    <button data-tab="pendiente" class="active">
      <i class="bi bi-hourglass-split"></i> Pendientes
    </button>
    <button data-tab="confirmada">
      <i class="bi bi-check-circle"></i> Confirmadas
    </button>
    <button data-tab="reagendada">
      <i class="bi bi-arrow-repeat"></i> Reagendadas
    </button>
    <button data-tab="cancelada">
      <i class="bi bi-x-circle"></i> Canceladas
    </button>
    <button data-tab="atendida">
      <i class="bi bi-clipboard-check"></i> Atendidas
    </button>
  </nav>

  <!-- LISTA -->
  <div id="reservas-list"></div>

  <!-- TEMPLATE -->
  <template id="reserva-template">
    <div class="reserva-card">
      <div class="reserva-header">
        <h3 class="servicio"></h3>
        <span class="estado"></span>
      </div>

      <div class="reserva-info">
        <p><strong>Fecha:</strong> <span class="fecha"></span></p>
        <p><strong>Hora:</strong> <span class="hora"></span></p>
      </div>

      <div class="reserva-actions"></div>
    </div>
  </template>

  <!-- DATA -->
  <script>
    window.RESERVAS_DATA = [
      {% for r in reservas %}
      {
        id: "{{ r.id }}",
        servicio: "{{ r.servicio.nombre }}",
        fecha: "{{ r.fecha }}",
        hora: "{{ r.hora }}",
        estado: "{{ r.estado }}",
        estado_label: "{{ r.get_estado_display }}",
        servicio_id: "{{ r.servicio.id }}"
      },
      {% endfor %}
    ];
  </script>

  {% else %}
    <p class="empty">AÃºn no tienes reservas registradas.</p>
  {% endif %}

  <a href="{% url 'home' %}" class="btn-back">
    <i class="bi bi-arrow-left"></i> Volver al inicio
  </a>

</main>

<script src="{% static 'appointments/js/mis_reservas.js' %}"></script>

</body>
</html>